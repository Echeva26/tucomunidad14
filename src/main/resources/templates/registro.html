<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Registrarse</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="stylesheet" href="../static/css/pag4c.css" />
</head>

<body>
    <!--CABECERA-->
    <!-- CABECERA -->
  <div class="cabecera">
    <span class="reserva-de-zonas">
    ¿No tienes cuenta?
    </span>
    
  </div>


    <!--PAGINA-->
    <div class="pagina">
        <!--REGISTRO-->
        <div class="container-6">
            <h2>Para unirte a tu comunidad, introduce los siguientes datos:</h2>
            <form id="registroForm" method="POST" action="/vecinos">
                <div class="column">
                    <label for="full_name">Nombre Completo:</label>
                    <input type="text" id="full_name" name="nombre" required>
                </div>
                <div class="column">
                    <label for="apellidos">Apellidos:</label>
                    <input type="text" id="apellidos" name="apellidos" required>
                </div>
                <div class="column">
                    <label for="email">Correo Electrónico:</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="column">
                    <label for="password">Contraseña:</label>
                    <input type="password" id="password" name="contraseña" required>
                </div>
                <div class="column">
                    <label for="username">Nombre de Usuario:</label>
                    <input type="text" id="username" name="nombredeusuario" required>
                </div>
                <div class="column">
                    <label for="community_id">ID de la Comunidad de Vecinos:</label>
                    <input type="text" id="community_id" name="idComunidad" required>
                </div>
                <div class="column">
                    <label for="confirm_password">Repetir Contraseña:</label>
                    <input type="password" id="confirm_password" name="confirm_password" required>
                </div>
                <input type="submit" id="registerButton" value="Registrarse">
            </form>
        </div>
    </div>

    <!--PIE DE PAGINA-->
    <div class="pie-de-pagina">
        <div class="container-5">
            <div class="image-2">
            </div>
            <div class="container-4">
                <img class="icon-1" src="../static/vectors/intagram.svg" />
                <img class="icon-2" src="../static/vectors/facebook.svg" />
                <img class="icon-3" src="../static/vectors/twitter.svg" />
            </div>
            <div class="idioma">
                <span class="language">
                    Idioma
                </span>
                <img class="icon-color" src="../static/vectors/flecha.svg" />
            </div>
        </div>
        <div class="description">
            Facilitamos la convivencia en tu comunidad
        </div>
        <div class="line">
        </div>
        <span class="tucom">
            ©TuComunidad 2024
        </span>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
          document.getElementById('registroForm').addEventListener('submit', function (e) {
              e.preventDefault();
              console.log("Formulario enviado");
  
              var data = {
                  nombre: document.getElementById('full_name').value,
                  apellidos: document.getElementById('apellidos').value,
                  email: document.getElementById('email').value,
                  nombredeusuario: document.getElementById('username').value,
                  contraseña: document.getElementById('password').value,
                  gestor: false,
                  idComunidad: document.getElementById('community_id').value
              };
  
              console.log("Datos del formulario:", data);
  
              fetch('vecinos', {
                  method: 'POST',
                  headers: {
                      'Content-Type': 'application/json',
                  },
                  body: JSON.stringify(data),
              })
                  .then(response => {
                      console.log("Respuesta del servidor:", response);
                      if (!response.ok) {
                          throw new Error('Network response was not ok');
                      }
                      console.log("POST hecho")
                      return response.json();
                  })
                  .then(data => {
                      console.log("Datos recibidos:", data.message);
                      window.location.href = '/menucomunidad?idvecino=' + data;
                  })
                  .catch((error) => {
                      console.error('Error:', error);
                  });
          });
      });
  </script>
</body>
   
</body>

</html>
